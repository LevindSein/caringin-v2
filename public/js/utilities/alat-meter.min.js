$(document).ready(function(){var e,t,a=$("#tabelAlatListrik").DataTable({serverSide:!0,ajax:{url:"/utilities/alatmeter",cache:!1},columns:[{data:"kode",name:"kode",class:"text-center"},{data:"nomor",name:"nomor",class:"text-center-td"},{data:"akhir",name:"akhir",class:"text-center"},{data:"daya",name:"daya",class:"text-center"},{data:"kd_kontrol",name:"tempat_usaha.kd_kontrol",class:"text-center"},{data:"action",name:"action",class:"text-center"}],stateSave:!0,deferRender:!0,pageLength:8,language:{paginate:{previous:"<i class='fas fa-angle-left'>",next:"<i class='fas fa-angle-right'>"}},aoColumnDefs:[{bSortable:!1,aTargets:[5]},{bSearchable:!1,aTargets:[5]}],responsive:!0});function r(){$("#listrik").is(":checked")?(document.getElementById("meteranListrik").style.display="block",document.getElementById("meteranAir").style.display="none"):(document.getElementById("meteranListrik").style.display="none",document.getElementById("meteranAir").style.display="block")}function s(){$("#listrik").is(":checked")?(document.getElementById("standListrik").required=!0,document.getElementById("dayaListrik").required=!0):(document.getElementById("standListrik").required=!1,document.getElementById("dayaListrik").required=!1)}function i(){$("#air").is(":checked")?document.getElementById("standAir").required=!0:document.getElementById("standAir").required=!1}setInterval(function(){a.ajax.reload(function(){console.log("Refresh Automatic")},!1)},6e4),$("#refresh").click(function(){$("#refresh-img").show(),$("#refresh").removeClass("btn-primary").addClass("btn-success").html("Refreshing"),a.ajax.reload(function(){console.log("Refresh Manual")},!1),setTimeout(function(){$("#refresh").removeClass("btn-success").addClass("btn-primary").html('<i class="fas fa-sync-alt"></i> Refresh Data'),$("#refresh-data").text("Refresh Data"),$("#refresh-img").hide()},2e3)}),$("#tab-c-1").click(function(){if(!$.fn.dataTable.isDataTable("#tabelAlatAir")){var e=$("#tabelAlatAir").DataTable({serverSide:!0,ajax:{url:"/utilities/alatmeter/air",cache:!1},columns:[{data:"kode",name:"kode",class:"text-center"},{data:"nomor",name:"nomor",class:"text-center-td"},{data:"akhir",name:"akhir",class:"text-center"},{data:"kd_kontrol",name:"tempat_usaha.kd_kontrol",class:"text-center"},{data:"action",name:"action",class:"text-center"}],stateSave:!0,deferRender:!0,pageLength:8,language:{paginate:{previous:"<i class='fas fa-angle-left'>",next:"<i class='fas fa-angle-right'>"}},aoColumnDefs:[{bSortable:!1,aTargets:[4]},{bSearchable:!1,aTargets:[4]}],responsive:!0});setInterval(function(){e.ajax.reload(function(){console.log("Refresh Automatic")},!1)},6e4),$("#refresh").click(function(){$("#refresh-img").show(),$("#refresh").removeClass("btn-primary").addClass("btn-success").html("Refreshing"),e.ajax.reload(function(){console.log("Refresh Manual")},!1),setTimeout(function(){$("#refresh").removeClass("btn-success").addClass("btn-primary").html('<i class="fas fa-sync-alt"></i> Refresh Data'),$("#refresh-data").text("Refresh Data"),$("#refresh-img").hide()},2e3)})}}),$("#add_alat").click(function(){$(".titles").text("Tambah Alat"),$("#action_btn").val("Tambah"),$("#action").val("Add"),$("#form_result").html(""),$("#form_alat")[0].reset(),$("#myModal").modal("show"),$("#listrik").prop("checked",!0),$("#meteranListrik").show(),$("#meteranAir").hide()}),$(document).on("click",".edit",function(){id=$(this).attr("id"),fas=$(this).attr("fas"),$("#form_result").html(""),$.ajax({url:"/utilities/alatmeter/edit/"+fas+"/"+id,cache:!1,dataType:"json",success:function(e){$("#nomor").val(e.result.nomor),"listrik"==fas?($("#listrik").prop("checked",!0),$('input[id="listrik"]').attr("disabled",!1),$('input[id="air"]').attr("disabled",!0),$("#meteranListrik").show(),$("#meteranAir").hide(),$("#standListrik").val(e.result.akhir),$("#dayaListrik").val(e.result.daya),$("#standAir").prop("required",!1)):($("#air").prop("checked",!0),$('input[id="air"]').attr("disabled",!1),$('input[id="listrik"]').attr("disabled",!0),$("#meteranListrik").hide(),$("#meteranAir").show(),$("#standAir").val(e.result.akhir),$("#standListrik").prop("required",!1),$("#dayaListrik").prop("required",!1)),$("#hidden_id").val(id),$(".titles").text("Edit Pedagang"),$("#action_btn").val("Update"),$("#action").val("Edit"),$("#myModal").modal("show")}})}),$("#form_alat").on("submit",function(e){e.preventDefault();var t="";"Add"==$("#action").val()&&(t="/utilities/alatmeter/store"),"Edit"==$("#action").val()&&(t="/utilities/alatmeter/update"),$.ajax({url:t,cache:!1,method:"POST",data:$(this).serialize(),dataType:"json",success:function(e){var t="";if("error"==e.result.status&&(t='<div class="alert alert-danger" id="error-alert"> <strong>Maaf ! </strong>'+e.result.message+"</div>"),"success"==e.result.status){t='<div class="alert alert-success" id="success-alert"> <strong>Sukses ! </strong>'+e.result.message+"</div>",$("#form_alat")[0].reset();try{"listrik"==e.result.role&&$("#tab-c-0").trigger("click"),"air"==e.result.role&&$("#tab-c-1").trigger("click")}catch(e){}finally{"listrik"==e.result.role&&$("#tabelAlatListrik").DataTable().ajax.reload(function(){},!1),"air"==e.result.role&&$("#tabelAlatAir").DataTable().ajax.reload(function(){},!1)}}"Edit"==$("#action").val()&&setTimeout(function(){$("#myModal").modal("hide")},3e3),$("#form_result").html(t),$("#listrik").prop("checked",!0),$("#meteranListrik").show(),$("#meteranAir").hide(),$('input[id="listrik"]').attr("disabled",!1),$('input[id="air"]').attr("disabled",!1),$("#form_alat")[0].reset(),$("#standAir").prop("required",!1),$("#standListrik").prop("required",!1),$("#dayaListrik").prop("required",!1),$("#success-alert,#error-alert,#info-alert,#warning-alert").fadeTo(1e3,500).slideUp(1e3,function(){$("#success-alert,#error-alert").slideUp(500)})}})}),$(document).on("click",".qr",function(){var e=$(this).attr("id"),t=$(this).attr("fas");window.open("/utilities/alatmeter/qr/"+t+"/"+e,"_blank")}),$(document).on("click",".delete",function(){e=$(this).attr("id"),t=$(this).attr("fas"),nama=$(this).attr("nama"),$(".titles").text("Hapus data "+t+" "+nama+" ?"),$("#confirmModal").modal("show")}),$("#ok_button").click(function(){$.ajax({url:"/utilities/alatmeter/destroy/"+t+"/"+e,cache:!1,beforeSend:function(){$("#ok_button").text("Menghapus...")},success:function(e){"listrik"==e.result.role&&$("#tabelAlatListrik").DataTable().ajax.reload(function(){},!1),"air"==e.result.role&&$("#tabelAlatAir").DataTable().ajax.reload(function(){},!1),e.result.success&&(html='<div class="alert alert-success" id="success-alert"> <strong>Sukses! </strong>'+e.result.success+"</div>"),e.result.errors&&(html='<div class="alert alert-danger" id="error-alert"> <strong>Oops! </strong>'+e.result.errors+"</div>"),$("#form_result").html(html),$("#success-alert,#error-alert,#info-alert,#warning-alert").fadeTo(1e3,500).slideUp(1e3,function(){$("#success-alert,#error-alert").slideUp(500)}),$("#confirmModal").modal("hide")},complete:function(){$("#ok_button").text("Hapus")}})}),$('input[type="radio"]').click(r).each(r),$("#myModal").on("shown.bs.modal",function(){$("#nomor").trigger("focus")}),document.getElementById("standAir").addEventListener("input",e=>e.target.value=(parseInt(e.target.value.replace(/[^\d]+/gi,""))||0).toLocaleString("en-US")),document.getElementById("standListrik").addEventListener("input",e=>e.target.value=(parseInt(e.target.value.replace(/[^\d]+/gi,""))||0).toLocaleString("en-US")),document.getElementById("dayaListrik").addEventListener("input",e=>e.target.value=(parseInt(e.target.value.replace(/[^\d]+/gi,""))||0).toLocaleString("en-US")),$('input[type="radio"]').click(s).each(s),$('input[type="radio"]').click(i).each(i),$("#nomor").on("keypress",function(e){var t=new RegExp("^[a-zA-Z0-9s-]+$"),a=String.fromCharCode(e.charCode?e.charCode:e.which);if(!t.test(a))return e.preventDefault(),!1}),$("#nomor").on("input",function(){/^,/.test(this.value)&&(this.value=this.value.replace(/^,/,""))})});