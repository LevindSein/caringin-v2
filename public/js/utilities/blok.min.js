$(document).ready(function(){var e,a=$("#tabelBlok").DataTable({serverSide:!0,ajax:{url:"/utilities/blok",cache:!1},columns:[{data:"nama",name:"nama",class:"text-center"},{data:"jumlah",name:"jumlah",class:"text-center"},{data:"action",name:"action",class:"text-center"}],stateSave:!0,deferRender:!0,pageLength:8,language:{paginate:{previous:"<i class='fas fa-angle-left'>",next:"<i class='fas fa-angle-right'>"}},aoColumnDefs:[{bSortable:!1,aTargets:[2]},{bSearchable:!1,aTargets:[2]}],responsive:!0});setInterval(function(){a.ajax.reload(function(){console.log("Refresh Automatic")},!1)},6e4),$("#refresh").click(function(){$("#refresh-img").show(),$("#refresh").removeClass("btn-primary").addClass("btn-success").html("Refreshing"),a.ajax.reload(function(){console.log("Refresh Manual")},!1),setTimeout(function(){$("#refresh").removeClass("btn-success").addClass("btn-primary").html('<i class="fas fa-sync-alt"></i> Refresh Data'),$("#refresh-data").text("Refresh Data"),$("#refresh-img").hide()},2e3)}),$("#add_blok").click(function(){$(".titles").text("Tambah Blok"),$("#action_btn").val("Tambah"),$("#action").val("Add"),$("#form_result").html(""),$("#form_blok")[0].reset(),$("#myModal").modal("show")}),$(document).on("click",".edit",function(){id=$(this).attr("id"),$("#form_result").html(""),$.ajax({url:"/utilities/blok/edit/"+id,cache:!1,dataType:"json",success:function(e){$("#blokInput").val(e.result.nama),$("#hidden_id").val(id),$(".titles").text("Edit Blok"),$("#action_btn").val("Update"),$("#action").val("Edit"),$("#myModal").modal("show")}})}),$("#form_blok").on("submit",function(e){e.preventDefault();var a="";"Add"==$("#action").val()&&(a="/utilities/blok/store"),"Edit"==$("#action").val()&&(a="/utilities/blok/update"),$.ajax({url:a,cache:!1,method:"POST",data:$(this).serialize(),dataType:"json",success:function(e){var a="";e.errors&&(a='<div class="alert alert-danger" id="error-alert"> <strong>Maaf ! </strong>'+e.errors+"</div>"),e.success&&(a='<div class="alert alert-success" id="success-alert"> <strong>Sukses ! </strong>'+e.success+"</div>",$("#form_blok")[0].reset(),$("#tabelBlok").DataTable().ajax.reload(function(){},!1)),$("#form_result").html(a),$("#success-alert,#error-alert,#info-alert,#warning-alert").fadeTo(1e3,500).slideUp(1e3,function(){$("#success-alert,#error-alert").slideUp(500)}),$("#myModal").modal("hide")}})}),$(document).on("click",".delete",function(){e=$(this).attr("id"),nama=$(this).attr("nama"),$(".titles").text("Hapus data "+nama+" ?"),$("#confirmModal").modal("show")}),$("#ok_button").click(function(){$.ajax({url:"/utilities/blok/destroy/"+e,cache:!1,beforeSend:function(){$("#ok_button").text("Menghapus...")},success:function(e){$("#tabelBlok").DataTable().ajax.reload(function(){},!1),e.success&&(html='<div class="alert alert-success" id="success-alert"> <strong>Sukses! </strong>'+e.success+"</div>"),e.errors&&(html='<div class="alert alert-danger" id="error-alert"> <strong>Oops! </strong>'+e.errors+"</div>"),$("#form_result").html(html),$("#success-alert,#error-alert,#info-alert,#warning-alert").fadeTo(1e3,500).slideUp(1e3,function(){$("#success-alert,#error-alert").slideUp(500)}),$("#confirmModal").modal("hide")},complete:function(){$("#ok_button").text("Hapus")}})}),$("#blokInput").on("keypress",function(e){var a=new RegExp("^[a-zA-Z0-9s-]+$"),t=String.fromCharCode(e.charCode?e.charCode:e.which);if(!a.test(t))return e.preventDefault(),!1}),$("#blokInput").on("input",function(){/^,/.test(this.value)?this.value=this.value.replace(/^,/,""):/^0/.test(this.value)&&(this.value=this.value.replace(/^0/,""))})});